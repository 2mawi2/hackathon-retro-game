<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Game Jam: Go Nuts!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: linear-gradient(135deg, #1a0a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }
        .arcade-cabinet {
            background: linear-gradient(180deg, #4a3f6b 0%, #2d2a4a 100%);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(138, 43, 226, 0.5), inset 0 0 20px rgba(0,0,0,0.5);
            border: 4px solid #6b5b95;
        }
        .title {
            text-align: center;
            color: #ffd700;
            font-size: 28px;
            text-shadow: 3px 3px 0 #ff6b6b, -2px -2px 0 #4ecdc4;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        .subtitle {
            text-align: center;
            color: #4ecdc4;
            font-size: 14px;
            margin-bottom: 15px;
        }
        canvas {
            border: 4px solid #333;
            border-radius: 5px;
            image-rendering: pixelated;
            background: #87ceeb;
        }
        .controls-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            color: #fff;
            font-size: 12px;
        }
        .player-controls {
            background: rgba(0,0,0,0.3);
            padding: 10px 15px;
            border-radius: 10px;
        }
        .p1 { border: 2px solid #ff6b6b; }
        .p2 { border: 2px solid #4ecdc4; }
        .player-controls h3 {
            margin-bottom: 5px;
            font-size: 14px;
        }
        .p1 h3 { color: #ff6b6b; }
        .p2 h3 { color: #4ecdc4; }
        .start-screen {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #ffd700;
            font-size: 20px;
            text-align: center;
        }
        .blink {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            50% { opacity: 0; }
        }
        .health-bars {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            gap: 20px;
        }
        .health-bar {
            flex: 1;
            height: 25px;
            background: #333;
            border: 2px solid #666;
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }
        .health-fill {
            height: 100%;
            transition: width 0.2s;
        }
        .health-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            text-shadow: 1px 1px 0 #000;
            z-index: 1;
        }
        .knight-health .health-fill { background: linear-gradient(90deg, #ff6b6b, #ff8e8e); }
        .robot-health .health-fill { background: linear-gradient(90deg, #4ecdc4, #7ee8e0); }
        .dragon-health { flex: 2; }
        .dragon-health .health-fill { background: linear-gradient(90deg, #2ecc71, #58d68d); }
    </style>
</head>
<body>
    <div class="arcade-cabinet">
        <div class="title">RETRO GAME JAM: GO NUTS!</div>
        <div class="subtitle">MULTIPLAYER MAYHEM!</div>

        <div class="health-bars">
            <div class="health-bar knight-health">
                <span class="health-label">KNIGHT</span>
                <div class="health-fill" id="knightHealth" style="width: 100%"></div>
            </div>
            <div class="health-bar dragon-health">
                <span class="health-label">DRAGON</span>
                <div class="health-fill" id="dragonHealth" style="width: 100%"></div>
            </div>
            <div class="health-bar robot-health">
                <span class="health-label">ROBOT</span>
                <div class="health-fill" id="robotHealth" style="width: 100%"></div>
            </div>
        </div>

        <canvas id="game" width="640" height="400"></canvas>

        <div class="controls-info">
            <div class="player-controls p1">
                <h3>1P START</h3>
                <div>WASD - Move</div>
                <div>SPACE - Attack</div>
            </div>
            <div class="player-controls p2">
                <h3>2P CO-OP!</h3>
                <div>Arrows - Move</div>
                <div>ENTER - Attack</div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');

        // Game state
        let gameState = 'start'; // start, playing, victory, gameover

        // Knight (Player 1)
        const knight = {
            x: 100,
            y: 280,
            width: 40,
            height: 60,
            speed: 4,
            health: 100,
            maxHealth: 100,
            attacking: false,
            attackTimer: 0,
            facing: 1, // 1 = right, -1 = left
            color: '#c0c0c0'
        };

        // Robot (Player 2)
        const robot = {
            x: 50,
            y: 280,
            width: 35,
            height: 55,
            speed: 4,
            health: 100,
            maxHealth: 100,
            attacking: false,
            attackTimer: 0,
            facing: 1,
            color: '#7f8c8d'
        };

        // Dragon (Enemy)
        const dragon = {
            x: 450,
            y: 240,
            width: 120,
            height: 100,
            health: 300,
            maxHealth: 300,
            attackTimer: 0,
            fireBreathTimer: 0,
            state: 'idle'
        };

        // Projectiles (dragon fire)
        let fireballs = [];

        // Input handling
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            keys[e.code] = true;
            if (gameState === 'start' && (e.code === 'Space' || e.code === 'Enter')) {
                gameState = 'playing';
            }
            if ((gameState === 'victory' || gameState === 'gameover') && (e.code === 'Space' || e.code === 'Enter')) {
                resetGame();
            }
        });
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
            keys[e.code] = false;
        });

        function resetGame() {
            knight.x = 100;
            knight.y = 280;
            knight.health = 100;
            knight.attacking = false;

            robot.x = 50;
            robot.y = 280;
            robot.health = 100;
            robot.attacking = false;

            dragon.x = 450;
            dragon.y = 240;
            dragon.health = 300;

            fireballs = [];
            gameState = 'playing';
        }

        function updateHealthBars() {
            document.getElementById('knightHealth').style.width = (knight.health / knight.maxHealth * 100) + '%';
            document.getElementById('robotHealth').style.width = (robot.health / robot.maxHealth * 100) + '%';
            document.getElementById('dragonHealth').style.width = (dragon.health / dragon.maxHealth * 100) + '%';
        }

        function update() {
            if (gameState !== 'playing') return;

            // Knight controls (WASD + Space)
            if (keys['a']) { knight.x -= knight.speed; knight.facing = -1; }
            if (keys['d']) { knight.x += knight.speed; knight.facing = 1; }
            if (keys['w']) knight.y -= knight.speed;
            if (keys['s']) knight.y += knight.speed;
            if (keys[' '] && !knight.attacking) {
                knight.attacking = true;
                knight.attackTimer = 20;
            }

            // Robot controls (Arrows + Enter)
            if (keys['arrowleft']) { robot.x -= robot.speed; robot.facing = -1; }
            if (keys['arrowright']) { robot.x += robot.speed; robot.facing = 1; }
            if (keys['arrowup']) robot.y -= robot.speed;
            if (keys['arrowdown']) robot.y += robot.speed;
            if (keys['Enter'] && !robot.attacking) {
                robot.attacking = true;
                robot.attackTimer = 20;
            }

            // Bounds checking
            knight.x = Math.max(0, Math.min(canvas.width - knight.width, knight.x));
            knight.y = Math.max(200, Math.min(canvas.height - knight.height - 60, knight.y));
            robot.x = Math.max(0, Math.min(canvas.width - robot.width, robot.x));
            robot.y = Math.max(200, Math.min(canvas.height - robot.height - 60, robot.y));

            // Attack timers
            if (knight.attacking) {
                knight.attackTimer--;
                if (knight.attackTimer <= 0) knight.attacking = false;
            }
            if (robot.attacking) {
                robot.attackTimer--;
                if (robot.attackTimer <= 0) robot.attacking = false;
            }

            // Check knight attack on dragon
            if (knight.attacking && knight.attackTimer === 18) {
                const attackX = knight.x + (knight.facing === 1 ? knight.width : -30);
                if (checkCollision({x: attackX, y: knight.y, width: 30, height: knight.height}, dragon)) {
                    dragon.health -= 15;
                }
            }

            // Check robot attack on dragon
            if (robot.attacking && robot.attackTimer === 18) {
                const attackX = robot.x + (robot.facing === 1 ? robot.width : -25);
                if (checkCollision({x: attackX, y: robot.y, width: 25, height: robot.height}, dragon)) {
                    dragon.health -= 12;
                }
            }

            // Dragon AI
            dragon.fireBreathTimer++;
            if (dragon.fireBreathTimer > 60) {
                dragon.fireBreathTimer = 0;
                // Fire at closest player
                const knightDist = Math.abs(knight.x - dragon.x);
                const robotDist = Math.abs(robot.x - dragon.x);
                const target = knightDist < robotDist ? knight : robot;

                fireballs.push({
                    x: dragon.x,
                    y: dragon.y + 40,
                    vx: -6,
                    vy: (target.y - dragon.y) * 0.02,
                    width: 20,
                    height: 15
                });
            }

            // Update fireballs
            fireballs = fireballs.filter(fb => {
                fb.x += fb.vx;
                fb.y += fb.vy;

                // Check collision with knight
                if (checkCollision(fb, knight)) {
                    knight.health -= 10;
                    return false;
                }
                // Check collision with robot
                if (checkCollision(fb, robot)) {
                    robot.health -= 10;
                    return false;
                }

                return fb.x > -20 && fb.x < canvas.width + 20;
            });

            updateHealthBars();

            // Win/lose conditions
            if (dragon.health <= 0) {
                gameState = 'victory';
            }
            if (knight.health <= 0 && robot.health <= 0) {
                gameState = 'gameover';
            }
        }

        function checkCollision(a, b) {
            return a.x < b.x + b.width &&
                   a.x + a.width > b.x &&
                   a.y < b.y + b.height &&
                   a.y + a.height > b.y;
        }

        function drawPixelRect(x, y, w, h, color) {
            ctx.fillStyle = color;
            ctx.fillRect(Math.floor(x), Math.floor(y), w, h);
        }

        function drawKnight(k) {
            const x = Math.floor(k.x);
            const y = Math.floor(k.y);

            // Helmet
            ctx.fillStyle = '#888';
            ctx.fillRect(x + 8, y, 24, 20);
            ctx.fillStyle = '#666';
            ctx.fillRect(x + 10, y + 8, 20, 8);

            // Red plume
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(x + 14, y - 8, 12, 10);

            // Body armor
            ctx.fillStyle = '#95a5a6';
            ctx.fillRect(x + 5, y + 20, 30, 25);

            // Legs
            ctx.fillStyle = '#7f8c8d';
            ctx.fillRect(x + 8, y + 45, 10, 15);
            ctx.fillRect(x + 22, y + 45, 10, 15);

            // Sword
            if (k.attacking) {
                ctx.fillStyle = '#f1c40f';
                if (k.facing === 1) {
                    ctx.fillRect(x + 35, y + 15, 35, 6);
                    ctx.fillRect(x + 30, y + 12, 8, 12);
                } else {
                    ctx.fillRect(x - 30, y + 15, 35, 6);
                    ctx.fillRect(x + 2, y + 12, 8, 12);
                }
            } else {
                ctx.fillStyle = '#f1c40f';
                if (k.facing === 1) {
                    ctx.fillRect(x + 35, y + 20, 8, 25);
                } else {
                    ctx.fillRect(x - 3, y + 20, 8, 25);
                }
            }
        }

        function drawRobot(r) {
            const x = Math.floor(r.x);
            const y = Math.floor(r.y);

            // Antenna
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(x + 15, y - 8, 4, 8);
            ctx.fillStyle = '#f00';
            ctx.fillRect(x + 13, y - 12, 8, 5);

            // Head
            ctx.fillStyle = '#3498db';
            ctx.fillRect(x + 5, y, 25, 20);

            // Eyes
            ctx.fillStyle = '#2ecc71';
            ctx.fillRect(x + 9, y + 6, 6, 6);
            ctx.fillRect(x + 20, y + 6, 6, 6);

            // Body
            ctx.fillStyle = '#2980b9';
            ctx.fillRect(x + 3, y + 20, 29, 22);

            // Chest light
            ctx.fillStyle = r.attacking ? '#f00' : '#0f0';
            ctx.fillRect(x + 13, y + 26, 8, 8);

            // Legs
            ctx.fillStyle = '#1a5276';
            ctx.fillRect(x + 6, y + 42, 8, 13);
            ctx.fillRect(x + 21, y + 42, 8, 13);

            // Arms / weapon
            if (r.attacking) {
                ctx.fillStyle = '#f39c12';
                if (r.facing === 1) {
                    ctx.fillRect(x + 32, y + 22, 20, 8);
                    // Laser effect
                    ctx.fillStyle = '#ff0';
                    ctx.fillRect(x + 52, y + 24, 15, 4);
                } else {
                    ctx.fillRect(x - 17, y + 22, 20, 8);
                    ctx.fillStyle = '#ff0';
                    ctx.fillRect(x - 32, y + 24, 15, 4);
                }
            }
        }

        function drawDragon() {
            const x = Math.floor(dragon.x);
            const y = Math.floor(dragon.y);

            // Body
            ctx.fillStyle = '#27ae60';
            ctx.fillRect(x + 20, y + 30, 80, 50);

            // Belly
            ctx.fillStyle = '#f1c40f';
            ctx.fillRect(x + 25, y + 40, 50, 35);

            // Head
            ctx.fillStyle = '#2ecc71';
            ctx.fillRect(x, y + 20, 40, 35);

            // Eye
            ctx.fillStyle = '#fff';
            ctx.fillRect(x + 8, y + 28, 12, 10);
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(x + 12, y + 30, 6, 6);

            // Mouth
            ctx.fillStyle = '#c0392b';
            ctx.fillRect(x, y + 45, 30, 8);

            // Teeth
            ctx.fillStyle = '#fff';
            for (let i = 0; i < 4; i++) {
                ctx.fillRect(x + 3 + i * 7, y + 45, 4, 5);
            }

            // Wings
            ctx.fillStyle = '#1e8449';
            ctx.beginPath();
            ctx.moveTo(x + 40, y + 30);
            ctx.lineTo(x + 80, y);
            ctx.lineTo(x + 100, y + 30);
            ctx.fill();

            // Tail
            ctx.fillStyle = '#27ae60';
            ctx.fillRect(x + 95, y + 50, 25, 15);
            ctx.fillRect(x + 115, y + 55, 15, 10);

            // Legs
            ctx.fillStyle = '#229954';
            ctx.fillRect(x + 30, y + 75, 15, 20);
            ctx.fillRect(x + 70, y + 75, 15, 20);
        }

        function drawFireball(fb) {
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(fb.x, fb.y, fb.width, fb.height);
            ctx.fillStyle = '#f39c12';
            ctx.fillRect(fb.x + 4, fb.y + 3, fb.width - 8, fb.height - 6);
            ctx.fillStyle = '#f1c40f';
            ctx.fillRect(fb.x + 8, fb.y + 5, fb.width - 16, fb.height - 10);
        }

        function drawGround() {
            // Sky gradient (already canvas bg)

            // Clouds
            ctx.fillStyle = '#fff';
            ctx.fillRect(50, 50, 60, 25);
            ctx.fillRect(40, 60, 80, 20);
            ctx.fillRect(200, 80, 50, 20);
            ctx.fillRect(190, 90, 70, 15);
            ctx.fillRect(450, 40, 55, 22);
            ctx.fillRect(440, 52, 75, 18);

            // Grass
            ctx.fillStyle = '#27ae60';
            ctx.fillRect(0, 340, canvas.width, 60);

            // Grass detail
            ctx.fillStyle = '#2ecc71';
            for (let i = 0; i < canvas.width; i += 20) {
                ctx.fillRect(i, 340, 15, 5);
            }

            // Ground/dirt
            ctx.fillStyle = '#8b4513';
            ctx.fillRect(0, 370, canvas.width, 30);

            // Ground detail
            ctx.fillStyle = '#a0522d';
            for (let i = 0; i < canvas.width; i += 30) {
                ctx.fillRect(i + 5, 375, 15, 8);
            }
        }

        function drawStartScreen() {
            ctx.fillStyle = 'rgba(0,0,0,0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#ffd700';
            ctx.font = '32px "Courier New"';
            ctx.textAlign = 'center';
            ctx.fillText('DRAGON SLAYERS', canvas.width/2, 150);

            ctx.fillStyle = '#4ecdc4';
            ctx.font = '16px "Courier New"';
            ctx.fillText('Defeat the Dragon together!', canvas.width/2, 190);

            ctx.fillStyle = '#ff6b6b';
            ctx.font = '14px "Courier New"';
            ctx.fillText('Player 1: WASD + SPACE', canvas.width/2, 250);
            ctx.fillStyle = '#4ecdc4';
            ctx.fillText('Player 2: ARROWS + ENTER', canvas.width/2, 275);

            ctx.fillStyle = '#ffd700';
            ctx.font = '20px "Courier New"';
            const blink = Math.floor(Date.now() / 500) % 2;
            if (blink) {
                ctx.fillText('PRESS SPACE OR ENTER TO START', canvas.width/2, 340);
            }
        }

        function drawVictoryScreen() {
            ctx.fillStyle = 'rgba(0,100,0,0.8)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#ffd700';
            ctx.font = '40px "Courier New"';
            ctx.textAlign = 'center';
            ctx.fillText('VICTORY!', canvas.width/2, 180);

            ctx.fillStyle = '#fff';
            ctx.font = '20px "Courier New"';
            ctx.fillText('The Dragon is defeated!', canvas.width/2, 230);

            ctx.font = '16px "Courier New"';
            const blink = Math.floor(Date.now() / 500) % 2;
            if (blink) {
                ctx.fillText('PRESS SPACE OR ENTER TO PLAY AGAIN', canvas.width/2, 320);
            }
        }

        function drawGameOverScreen() {
            ctx.fillStyle = 'rgba(100,0,0,0.8)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#ff0000';
            ctx.font = '40px "Courier New"';
            ctx.textAlign = 'center';
            ctx.fillText('GAME OVER', canvas.width/2, 180);

            ctx.fillStyle = '#fff';
            ctx.font = '20px "Courier New"';
            ctx.fillText('The Dragon wins...', canvas.width/2, 230);

            ctx.font = '16px "Courier New"';
            const blink = Math.floor(Date.now() / 500) % 2;
            if (blink) {
                ctx.fillText('PRESS SPACE OR ENTER TO TRY AGAIN', canvas.width/2, 320);
            }
        }

        function draw() {
            // Clear
            ctx.fillStyle = '#87ceeb';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            drawGround();
            drawDragon();
            if (knight.health > 0) drawKnight(knight);
            if (robot.health > 0) drawRobot(robot);
            fireballs.forEach(drawFireball);

            if (gameState === 'start') {
                drawStartScreen();
            } else if (gameState === 'victory') {
                drawVictoryScreen();
            } else if (gameState === 'gameover') {
                drawGameOverScreen();
            }
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>
